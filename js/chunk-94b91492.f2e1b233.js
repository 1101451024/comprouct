(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-94b91492"],{"0554":function(t,e,s){"use strict";var a=s("7e2f"),i=s.n(a);i.a},4455:function(t,e,s){"use strict";(function(t){s("4917"),s("a481");var a=s("025e");e["a"]={data:function(){return{imgList:[],fileList:[],uploadCount:0,Photos:[],ishidden:!0,isCount:!0,num:5}},created:function(){var t=this;this.$nextTick(function(){console.log(t.isCount),!0===t.isCount?t.num=5:t.num=8})},mounted:function(){var e=this,s="http://wkf.yiwindow.com/backend/",i=s+"server/media/upload?type=image";this.$nextTick(function(){e.$weui.uploader("#uploader",{url:i,auto:!0,type:"file",fileVal:"media",compress:{width:1600,height:1600,quality:.8},onBeforeQueued:function(t){return["image/jpg","image/jpeg","image/png","image/gif"].indexOf(this.type)<0?(e.$weui.alert("请上传图片"),!1):this.size>10485760?(e.$weui.alert("请上传不超过10M的图片"),!1):t.length>e.num?(e.$weui.alert("最多只能上传"+e.num+"张图片，请重新选择"),!1):e.uploadCount+1>e.num?(e.$weui.alert("最多只能上传"+e.num+"张图片"),!1):void++e.uploadCount},onQueued:function(){var t=this;a["a"].blobTobase(t,function(e){t.url=e})},onBeforeSend:function(s,a){t.extend(a,{Authorization:e.$store.state.Token})},onProgress:function(t){},onSuccess:function(t){e.imgList.push(this),0===t.code?e.Photos.push(t.result.fuid):e.$weui.alert(t.msg)},onError:function(t){console.log(this,t)}})})},watch:{uploadCount:function(t,e){t==this.num?this.ishidden=!1:this.ishidden=!0,console.log(t)}},methods:{handelGallery:function(t){console.log("执行了");var e=t.target,s=this;while(!e.classList.contains("weui-uploader__file")&&e)e=e.parentNode;if(e){var a=e.getAttribute("style")||"",i=e.getAttribute("data-id");a&&(a=a.match(/url\((.*?)\)/)[1].replace(/"/g,""));var l=s.$weui.gallery(a,{onDelete:function(){s.$weui.confirm("确定删除该图片？",function(){for(var t,a=0,n=s.imgList.length;a<n;a++){var o=s.imgList[a];if(o.id==i){t=a;break}}t>=0&&(console.log(t),s.Photos.splice(t,1),s.imgList.splice(t,1)),s.uploadCount--,e.remove(),l.hide()},function(){console.log("no deleted~ ~ ~ ~ ~ ~")})}})}}}}}).call(this,s("1157"))},4917:function(t,e,s){"use strict";var a=s("cb7c"),i=s("9def"),l=s("0390"),n=s("5f1b");s("214f")("match",1,function(t,e,s,o){return[function(s){var a=t(this),i=void 0==s?void 0:s[e];return void 0!==i?i.call(s,a):new RegExp(s)[e](String(a))},function(t){var e=o(s,t,this);if(e.done)return e.value;var r=a(t),c=String(this);if(!r.global)return n(r,c);var u=r.unicode;r.lastIndex=0;var d,p=[],_=0;while(null!==(d=n(r,c))){var h=String(d[0]);p[_]=h,""===h&&(r.lastIndex=l(c,i(r.lastIndex),u)),_++}return 0===_?null:p}]})},"4dac":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"describe_item"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.isDescribe,expression:"!isDescribe"}],staticClass:"describe_placeholder"},[t._v(t._s(t.placeText))]),s("div",{staticClass:"describe_edit",attrs:{contenteditable:"plaintext-only"},domProps:{innerHTML:t._s(t.innerText)},on:{focus:t.focusIn,input:t.changeText,blur:t.blurIn}})])},i=[],l={data:function(){return{isDescribe:"",innerText:"",placeText:"",bodys:0}},props:["placetxt"],mounted:function(){this.$parent.textVal2||this.$parent.textVal?(this.innerText=this.$parent.textVal2,this.placeText=""):this.placeText=this.$parent.placetxt},methods:{changeText:function(){this.isDescribe=this.$el.lastChild.innerHTML,this.$emit("edit-handler",this.$el.lastChild.innerHTML)},focusIn:function(){this.bodys=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop},blurIn:function(){window.scroll(0,this.bodys)}},watch:{value:function(t){this.innerText||(this.innerText=t)}}},n=l,o=(s("9bef"),s("2877")),r=Object(o["a"])(n,a,i,!1,null,"a3c529bc",null);e["a"]=r.exports},"7e2f":function(t,e,s){},"9bef":function(t,e,s){"use strict";var a=s("fbd1"),i=s.n(a);i.a},c280:function(t,e,s){},e21f:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.msgData?s("div",{staticClass:"pages msgData"},[s("div",{staticClass:"weui-panel"},[s("div",{staticClass:"repair_data_header"},[s("div",{staticClass:"header_left"},[s("span",{staticClass:"state",class:"weixiu"+t.comInfo.status}),"1"===t.comInfo.status?s("span",[t._v("待维修")]):"2"===t.comInfo.status?s("span",[t._v("已维修")]):"3"===t.comInfo.status?s("span",[t._v("已完成")]):s("span",[t._v("已评价")])])]),s("div",{staticClass:"weui-panel__bd"},[s("a",{staticClass:"weui-media-box weui-media-box_appmsg",attrs:{href:"javascript:void(0);"}},[s("div",{staticClass:"weui-media-box__bd"},["1"===t.comInfo.status||"2"===t.comInfo.status?s("div",{staticClass:"notComponey"},["1"===t.comInfo.status?s("div",{staticClass:"tip"},[t._v("尊敬的业主/住户：您好！您的报修我们已收到，我们会尽快联系处理。负责工作人员信息：")]):"2"===t.comInfo.status?s("div",{staticClass:"tip"},[t._v("尊敬的业主/住户：您好！您的报修我们已维修，为确保维修质量，我们正在复核验收中。负责工作人员信息：")]):t._e(),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"label"},[t._v("工作人员:")]),s("p",{staticClass:"wx_flex col_name"},[t._v(t._s(t.comData.handler))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"label"},[t._v("联系电话:")]),s("p",{staticClass:"wx_flex col_phone"},[s("a",{attrs:{href:"tel:"+t.comData.handler_telephone}},[t._v(t._s(t.comData.handler_telephone))])])])]):"3"===t.comInfo.status?s("div",{staticClass:"componey"},[s("div",{staticClass:"tip"},[t._v("尊敬的业主/住户：您好！您的报修已完成维修，谢谢您使用微信客服系统。")]),s("div",{},[s("button",{staticClass:"weui-btn weui-btn_primary ly-btn_whiter",on:{click:t.getExmine}},[t._v("我要评价")])])]):t._e()])])])]),"1"===t.comInfo.status||"2"===t.comInfo.status?s("div",{staticClass:"weui-cells mar_top10"},[t._m(0),s("div",{staticClass:"weui-cell beforeTop textAreas"},[s("com-textarea",{ref:"childText",on:{"edit-handler":t.onEditHandler}})],1),s("com-upload",{ref:"childUpload"}),s("div",{staticClass:"weui-btn-area"},[s("button",{staticClass:"weui-btn weui-btn_primary ly-btn_defalut",on:{click:t.newQuery}},[t._v("确定")])])],1):t._e(),s("div",{staticClass:"requairMsg mar_top15"},[s("div",{staticClass:"weui-panel"},[t._m(1),s("div",{staticClass:"weui-panel__bd"},[s("a",{staticClass:"weui-media-box weui-media-box_appmsg",attrs:{href:"javascript:void(0);"}},[s("div",{staticClass:"weui-media-box__bd"},[s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("报修房屋:")]),s("p",{staticClass:"wx_flexs"},[t._v(t._s(t.comInfo.repair_room))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("报修区域:")]),s("p",{staticClass:"wx_flexs"},[t._v(t._s(t.comInfo.repair_area))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label  ly-label label"},[t._v("报修项目:")]),s("p",{staticClass:"wx_flexs"},[t._v(t._s(t.comInfo.repair_type))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("问题描述:")]),s("p",{staticClass:"wx_flex"},[t._v(t._s(t.comInfo.content))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("联系人:")]),s("p",{staticClass:"wx_flexs"},[t._v(t._s(t.comInfo.name))])]),s("div",{staticClass:"repair_data"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("联系电话:")]),s("p",{staticClass:"wx_flexs col_phone"},[s("a",{attrs:{href:"tel:"+t.comInfo.telephone}},[t._v(t._s(t.comInfo.telephone))])])]),t.photos.length>0?s("div",{staticClass:"repair_data flex1"},[s("p",{staticClass:"weui-label ly-label label"},[t._v("上传图片")]),s("div",{staticClass:"repair_img"},[s("ul",t._l(t.photos,function(t){return s("li",[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t,expression:"imgurl"}],key:t,attrs:{preview:"100",alt:""}})])}),0)])]):t._e()])])])])]),t.addMsg.length>0?s("div",{staticClass:"supple_msg mar_top10"},[s("div",{staticClass:"weui-panel mar_bott"},[t._m(2),s("div",{staticClass:"weui-panel__bd"},t._l(t.addMsg,function(e,a){return s("div",{staticClass:"repair_datas repair_flex"},[s("p",{staticClass:"media_left"},[t._v(t._s(t.comInfo.name))]),s("div",{staticClass:"weui-media-box media_right"},[s("div",{staticClass:"arcticle"},[s("p",[t._v(t._s(e.content))]),e.photos.length>0?s("div",{staticClass:"repair_img"},[s("ul",t._l(e.photos,function(t){return s("li",[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t,expression:"imgs"}],key:t,attrs:{preview:a,alt:""}})])}),0)]):t._e()]),s("ul",{staticClass:"weui-media-box__info"},[s("li",{staticClass:"weui-media-box__info__meta"},[t._v(t._s(e.created_at))])]),t._m(3,!0)])])}),0)])]):t._e(),s("div",{staticClass:"weui-btn-area area"},[s("button",{staticClass:"weui-btn ly-btn_defalut",on:{click:t.reClose}},[t._v("返回")])])]):t._e()},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"weui-cells__title"},[s("p",{staticStyle:{color:"#000"}},[t._v("问题补充")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"weui-panel__hd"},[s("div",{staticClass:"msgTxt"},[s("span",[t._v("报修信息")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"weui-panel__hd"},[s("div",{staticClass:"msgTxt"},[s("span",[t._v("补充信息")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"foot_info"},[s("p",[t._v("您补充信息已收到，我们会继续跟进。")])])}],l=s("d722"),n=s("4dac"),o=s("f037"),r={data:function(){return{title:"",stateColor:"",comText:[],isShow:!1,placetxt:"如果你有新的内容补充，请在此录入",type:"",repairData:[],code:this.$store.state.roomCode||"",comData:{},comInfo:{},msgData:!1,isload:!0,loadmore:"加载更多",current:1,photos:[],allcount:0,addMsg:[]}},created:function(){this.type=this.$route.query.type,this.init()},components:{ComTextarea:n["a"],ComUpload:o["a"]},methods:{init:function(){var t=this,e="",s="";1===this.current&&(s=this.$weui.loading()),"repair"===this.type?(e={company_repair_code:this.code},Object(l["y"])(e).then(function(e){console.log(e),0===e.code?1===t.current&&(t.isload=!0,t.comData=e.result,t.comInfo=e.result.repair_info,t.photos=e.result.repair_info.photos,t.addMsg=e.result.repair_additional,t.allcount=t.addMsg.length,t.msgData=!0,s.hide()):(1===t.current&&s.hide(),t.$weui.alert(e.msg))})):"prorepair"===this.type?(e={property_repair_code:this.code},Object(l["t"])(e).then(function(e){console.log(e),0===e.code?1===t.current&&(t.isload=!0,t.comData=e.result,t.comInfo=e.result.repair_info,t.photos=e.result.repair_info.photos,t.addMsg=e.result.repair_additional,t.allcount=t.addMsg.length,t.msgData=!0,s.hide()):(1===t.current&&s.hide(),t.$weui.alert(e.msg))})):this.$router.push("/home")},getExmine:function(){this.$router.push({name:"Examine",query:{type:this.type}})},onEditHandler:function(t){this.textVal=t,console.log(t)},newQuery:function(){var t=this;if("repair"===this.type){var e={company_repair_code:this.code,content:this.textVal,photos:this.$refs.childUpload.Photos};Object(l["f"])(e).then(function(e){console.log(e),0===e.code?t.resuccess():t.$weui.alert(e.msg)})}else if("prorepair"===this.type){var s={property_repair_code:this.code,content:this.textVal,photos:this.$refs.childUpload.Photos};Object(l["E"])(s).then(function(e){console.log(e),0===e.code?t.resuccess():t.$weui.alert(e.msg)})}},resuccess:function(){var t=this;this.$store.commit("setReFresh",1),this.$weui.alert("提交成功",{buttons:[{label:"确定",type:"primary",onClick:function(){t.$router.push({name:"HouseRepair",query:{type:t.type}})}}]})},reClose:function(){this.$router.push({name:"HouseRepair",query:{type:this.type}})}}},c=r,u=(s("0554"),s("2877")),d=Object(u["a"])(c,a,i,!1,null,"289691a6",null);e["default"]=d.exports},f037:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"weui-cells weui-cells_form mar_bott mar_top0 ",attrs:{id:"uploader"}},[s("div",{staticClass:"weui-cell"},[s("div",{staticClass:"weui-cell__bd"},[s("div",{staticClass:"weui-uploader"},[s("div",{staticClass:"weui-uploader__hd"},[s("p",{staticClass:"weui-uploader__title titleImg"},[t._v("上传照片 "),t.isCount?s("span",{staticClass:"countImg"},[t._v("(最多5张)")]):s("span",{staticClass:"countImg"},[t._v("(非必选  最多8张)")])])]),s("div",{staticClass:"weui-uploader__bd"},[s("ul",{staticClass:"weui-uploader__files",attrs:{id:"uploaderCustomFiles"},on:{click:function(e){return t.handelGallery(e)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.ishidden,expression:"ishidden"}],staticClass:"weui-uploader__input-box uploadImg"},[s("input",{staticClass:"weui-uploader__input",attrs:{id:"uploaderCustomInput",name:"img[]",type:"file",accept:"image/*",multiple:""}})])])])])])])},i=[],l=s("4455"),n=l["a"],o=(s("f368"),s("2877")),r=Object(o["a"])(n,a,i,!1,null,"7e27ba3f",null);e["a"]=r.exports},f368:function(t,e,s){"use strict";var a=s("c280"),i=s.n(a);i.a},fbd1:function(t,e,s){}}]);